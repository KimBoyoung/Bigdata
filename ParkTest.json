{"paragraphs":[{"text":"%spark\nval schema = new StructType().\n                add(\"_c0\", StringType, true).\n                add(\"enter\", IntegerType, true).\n                add(\"egate\", StringType, true).\n                add(\"year\", StringType, true).\n                add(\"month\", StringType, true).\n                add(\"day\", StringType, true).\n                add(\"weekday\", StringType, true)\n                \nval df = spark.read.options(Map(\"sep\"->\",\", \"header\"->\"true\")).schema(schema).csv(\"hdfs:///user/maria_dev/ChildrenParkData5.csv\")\ndf.printSchema\ndf.show()","user":"anonymous","dateUpdated":"2019-09-30T09:27:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(_c0,StringType,true), StructField(enter,IntegerType,true), StructField(egate,StringType,true), StructField(year,StringType,true), StructField(month,StringType,true), StructField(day,StringType,true), StructField(weekday,StringType,true))\ndf: org.apache.spark.sql.DataFrame = [_c0: string, enter: int ... 5 more fields]\nroot\n |-- _c0: string (nullable = true)\n |-- enter: integer (nullable = true)\n |-- egate: string (nullable = true)\n |-- year: string (nullable = true)\n |-- month: string (nullable = true)\n |-- day: string (nullable = true)\n |-- weekday: string (nullable = true)\n\n+---+-----+-----+----+-----+---+-------+\n|_c0|enter|egate|year|month|day|weekday|\n+---+-----+-----+----+-----+---+-------+\n|  0| 3343|   정문|2009|   01| 01|    목요일|\n|  1| 2570|   정문|2009|   01| 02|    금요일|\n|  2| 3831|   정문|2009|   01| 03|    토요일|\n|  3| 5202|   정문|2009|   01| 04|    일요일|\n|  4| 2854|   정문|2009|   01| 05|    월요일|\n|  5| 3781|   정문|2009|   01| 06|    화요일|\n|  6| 2851|   정문|2009|   01| 07|    수요일|\n|  7| 3025|   정문|2009|   01| 08|    목요일|\n|  8| 3881|   정문|2009|   01| 09|    금요일|\n|  9| 1966|   정문|2009|   01| 10|    토요일|\n| 10| 3025|   정문|2009|   01| 11|    일요일|\n| 11| 1382|   정문|2009|   01| 12|    월요일|\n| 12| 1593|   정문|2009|   01| 13|    화요일|\n| 13| 1715|   정문|2009|   01| 14|    수요일|\n| 14|  487|   정문|2009|   01| 16|    금요일|\n| 15| 3315|   정문|2009|   01| 17|    토요일|\n| 16| 4196|   정문|2009|   01| 18|    일요일|\n| 17| 1997|   정문|2009|   01| 19|    월요일|\n| 18| 4148|   정문|2009|   01| 20|    화요일|\n| 19| 3410|   정문|2009|   01| 21|    수요일|\n+---+-----+-----+----+-----+---+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1569823852994_2065543084","id":"20190930-061052_2127057501","dateCreated":"2019-09-30T06:10:52+0000","dateStarted":"2019-09-30T09:27:26+0000","dateFinished":"2019-09-30T09:27:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:471"},{"text":"%spark\ndf.registerTempTable(\"park\")","user":"anonymous","dateUpdated":"2019-09-30T09:28:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1569824070714_-414088601","id":"20190930-061430_26420383","dateCreated":"2019-09-30T06:14:30+0000","dateStarted":"2019-09-30T09:28:14+0000","dateFinished":"2019-09-30T09:30:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:472"},{"text":"%sql\nSELECT * FROM park LIMIT 10","user":"anonymous","dateUpdated":"2019-09-30T09:30:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_c0\tenter\tegate\tyear\tmonth\tday\tweekday\n0\t3343\t정문\t2009\t01\t01\t목요일\n1\t2570\t정문\t2009\t01\t02\t금요일\n2\t3831\t정문\t2009\t01\t03\t토요일\n3\t5202\t정문\t2009\t01\t04\t일요일\n4\t2854\t정문\t2009\t01\t05\t월요일\n5\t3781\t정문\t2009\t01\t06\t화요일\n6\t2851\t정문\t2009\t01\t07\t수요일\n7\t3025\t정문\t2009\t01\t08\t목요일\n8\t3881\t정문\t2009\t01\t09\t금요일\n9\t1966\t정문\t2009\t01\t10\t토요일\n"}]},"apps":[],"jobName":"paragraph_1569824122781_-220651849","id":"20190930-061522_1094033327","dateCreated":"2019-09-30T06:15:22+0000","dateStarted":"2019-09-30T09:30:55+0000","dateFinished":"2019-09-30T09:31:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:473"},{"text":"%sql\nSELECT egate, avg(enter) as counts FROM park\nGROUP BY egate\nORDER BY avg(enter) DESC","user":"anonymous","dateUpdated":"2019-09-30T09:31:18+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"egate\tcounts\n정문\t13139.110117211598\n후문\t9561.678738682485\n구의문\t5149.537574056751\n능동문\t2960.7700348432054\n"}]},"apps":[],"jobName":"paragraph_1569824158683_2004397013","id":"20190930-061558_74323170","dateCreated":"2019-09-30T06:15:58+0000","dateStarted":"2019-09-30T09:31:21+0000","dateFinished":"2019-09-30T09:31:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:474"},{"text":"%sql\nSELECT year, sum(enter) FROM park\nGROUP BY year\nORDER BY year","user":"anonymous","dateUpdated":"2019-09-30T09:32:13+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tsum(enter)\n2009\t24290720\n2010\t12922469\n2011\t13472117\n2012\t11002036\n2013\t11124017\n2014\t9408613\n2015\t8915052\n2016\t7949746\n"}]},"apps":[],"jobName":"paragraph_1569824207169_-1125510099","id":"20190930-061647_1923814136","dateCreated":"2019-09-30T06:16:47+0000","dateStarted":"2019-09-30T09:32:17+0000","dateFinished":"2019-09-30T09:32:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:475"},{"text":"%sql\nSELECT month, avg(enter) FROM park\nGROUP BY month ORDER BY month ASC","user":"anonymous","dateUpdated":"2019-09-30T11:40:31+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"month","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(enter)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"month\tavg(enter)\n01\t3451.2347031963473\n02\t3979.920792079208\n03\t5681.956678700361\n04\t13257.9738317757\n05\t16588.47392086331\n06\t8341.81970260223\n07\t6563.821234119782\n08\t7095.600548446069\n09\t8547.492931196985\n10\t9621.844061650045\n11\t5296.431411530815\n12\t3473.472222222222\n"}]},"apps":[],"jobName":"paragraph_1569824350082_-820188038","id":"20190930-061910_889637996","dateCreated":"2019-09-30T06:19:10+0000","dateStarted":"2019-09-30T09:32:57+0000","dateFinished":"2019-09-30T09:33:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:476"},{"text":"%sql\nSELECT weekday, avg(enter) FROM park\nGROUP BY weekday ORDER BY avg(enter) DESC","user":"anonymous","dateUpdated":"2019-09-30T15:19:33+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false},"pieChart":{}},"commonSetting":{},"keys":[{"name":"weekday","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(enter)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"weekday\tavg(enter)\n일요일\t11836.468973091707\n토요일\t11331.85838307108\n금요일\t6468.145524437123\n목요일\t6288.302452316077\n화요일\t6285.203269754768\n수요일\t6221.265753424657\n월요일\t5708.7255330781845\n"}]},"apps":[],"jobName":"paragraph_1569824370113_1204406647","id":"20190930-061930_2013927352","dateCreated":"2019-09-30T06:19:30+0000","dateStarted":"2019-09-30T12:30:23+0000","dateFinished":"2019-09-30T12:30:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:477"},{"text":"%sql\nselect month, day, round(avg(enter),0) as count from park\nwhere month = 01 and day = 01 or month = 05 and day = 05 or month = 03 and day = 01 or month = 06 and day = 06 or month = 08 and day = 15 or month = 10 and day = 03 or month = 10 and day = 09 or month = 12 and day = 25\ngroup by month, day\norder by count desc","user":"anonymous","dateUpdated":"2019-09-30T15:05:37+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{},"stackedAreaChart":{"style":"expand"}},"commonSetting":{},"keys":[{"name":"month","index":0,"aggr":"sum"},{"name":"day","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569843773350_-1298978631","id":"20190930-114253_2075475210","dateCreated":"2019-09-30T11:42:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2257","dateFinished":"2019-09-30T15:00:44+0000","dateStarted":"2019-09-30T14:58:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"month\tday\tcount\n05\t05\t98319.0\n06\t06\t20214.0\n10\t03\t17057.0\n10\t09\t14043.0\n08\t15\t9952.0\n03\t01\t7000.0\n12\t25\t4917.0\n01\t01\t4613.0\n"}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2019-09-30T13:24:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569849887329_-591999344","id":"20190930-132447_1021103111","dateCreated":"2019-09-30T13:24:47+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2765"}],"name":"Park Test2","id":"2EQE15AQC","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}